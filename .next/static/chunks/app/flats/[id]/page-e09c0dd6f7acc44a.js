(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[437],{1603:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var n=a(5155),l=a(5695),r=a(2115),s=a(700),o=a(7217),i=a(8407),u=a(4581),c=a(3731),d=a(8534);function h(e){let{params:t}=e,a=(0,l.useRouter)(),[h,m]=(0,r.useState)(null),[p,f]=(0,r.useState)(""),[x,v]=(0,r.useState)(""),[g,j]=(0,r.useState)([]),[A,y]=(0,r.useState)(""),[b,w]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{let{id:e}=await t;w(e),e&&fetch("/api/flats/".concat(e)).then(e=>e.json()).then(e=>{m(e),f(e.name),v(e.description),j(e.notes)})})()},[t]);let C=async e=>{e.preventDefault(),b&&((await fetch("/api/flats/".concat(b),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:p,description:x,newNote:A})})).ok?a.push("/flats"):console.error("Failed to update flat"))},S=async()=>{b&&((await fetch("/api/flats/".concat(b),{method:"DELETE"})).ok?a.push("/flats"):console.error("Failed to delete flat"))};return h?(0,n.jsxs)(o.A,{component:i.A,sx:{p:4,mt:4},children:[(0,n.jsx)(s.A,{variant:"h4",component:"h1",gutterBottom:!0,children:"Edit Flat"}),(0,n.jsxs)(u.A,{component:"form",onSubmit:C,sx:{mt:2},children:[(0,n.jsx)(c.A,{label:"Flat Name",variant:"outlined",fullWidth:!0,value:p,onChange:e=>f(e.target.value),margin:"normal",required:!0}),(0,n.jsx)(c.A,{label:"Description (where it is)",variant:"outlined",fullWidth:!0,multiline:!0,rows:4,value:x,onChange:e=>v(e.target.value),margin:"normal"}),(0,n.jsx)(c.A,{label:"Add New Note",variant:"outlined",fullWidth:!0,multiline:!0,rows:2,value:A,onChange:e=>y(e.target.value),margin:"normal"}),(0,n.jsxs)(u.A,{sx:{mt:3,display:"flex",gap:2},children:[(0,n.jsx)(d.A,{type:"submit",variant:"contained",color:"primary",children:"Save Changes"}),(0,n.jsx)(d.A,{variant:"outlined",color:"secondary",onClick:S,children:"Delete Flat"}),(0,n.jsx)(d.A,{variant:"outlined",onClick:()=>a.push("/flats"),children:"Cancel"})]})]}),(0,n.jsxs)(u.A,{sx:{mt:4},children:[(0,n.jsx)(s.A,{variant:"h5",gutterBottom:!0,children:"Note History"}),0===g.length?(0,n.jsx)(s.A,{children:"No notes yet."}):g.map(e=>(0,n.jsxs)(i.A,{sx:{p:2,mb:2,bgcolor:"background.paper"},children:[(0,n.jsx)(s.A,{variant:"body2",color:"text.secondary",children:new Date(e.date).toLocaleString()}),(0,n.jsx)(s.A,{variant:"body1",children:e.note})]},e.id))]})]}):(0,n.jsx)(s.A,{children:"Loading..."})}},5695:(e,t,a)=>{"use strict";var n=a(8999);a.o(n,"useParams")&&a.d(t,{useParams:function(){return n.useParams}}),a.o(n,"useRouter")&&a.d(t,{useRouter:function(){return n.useRouter}})},8430:(e,t,a)=>{Promise.resolve().then(a.bind(a,1603))}},e=>{var t=t=>e(e.s=t);e.O(0,[4475,9008,3731,8441,1684,7358],()=>t(8430)),_N_E=e.O()}]);