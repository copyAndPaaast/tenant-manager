(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8603],{3127:(e,t,a)=>{"use strict";a.d(t,{A:()=>C});var n=a(2115),r=a(2596),i=a(7472),o=a(4391),s=a(4739),l=a(5955),d=a(680),c=a(8963),h=a(186),p=a(4820),x=a(4426),u=a(3209),m=a(5170),y=a(870);function A(e){return(0,y.Ay)("MuiIconButton",e)}let g=(0,m.A)("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]);var j=a(5155);let b=e=>{let{classes:t,disabled:a,color:n,edge:r,size:o,loading:s}=e,l={root:["root",s&&"loading",a&&"disabled","default"!==n&&"color".concat((0,u.A)(n)),r&&"edge".concat((0,u.A)(r)),"size".concat((0,u.A)(o))],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return(0,i.A)(l,A,t)},v=(0,l.Ay)(p.A,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:a}=e;return[t.root,a.loading&&t.loading,"default"!==a.color&&t["color".concat((0,u.A)(a.color))],a.edge&&t["edge".concat((0,u.A)(a.edge))],t["size".concat((0,u.A)(a.size))]]}})((0,d.A)(e=>{let{theme:t}=e;return{textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),variants:[{props:e=>!e.disableRipple,style:{"--IconButton-hoverBg":t.vars?"rgba(".concat(t.vars.palette.action.activeChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,o.X4)(t.palette.action.active,t.palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]}}),(0,d.A)(e=>{let{theme:t}=e;return{variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(t.palette).filter((0,c.A)()).map(e=>{let[a]=e;return{props:{color:a},style:{color:(t.vars||t).palette[a].main}}}),...Object.entries(t.palette).filter((0,c.A)()).map(e=>{let[a]=e;return{props:{color:a},style:{"--IconButton-hoverBg":t.vars?"rgba(".concat((t.vars||t).palette[a].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,o.X4)((t.vars||t).palette[a].main,t.palette.action.hoverOpacity)}}}),{props:{size:"small"},style:{padding:5,fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:t.typography.pxToRem(28)}}],["&.".concat(g.disabled)]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled},["&.".concat(g.loading)]:{color:"transparent"}}})),f=(0,l.Ay)("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(e=>{let{theme:t}=e;return{display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(t.vars||t).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]}}),C=n.forwardRef(function(e,t){let a=(0,h.b)({props:e,name:"MuiIconButton"}),{edge:n=!1,children:i,className:o,color:l="default",disabled:d=!1,disableFocusRipple:c=!1,size:p="medium",id:u,loading:m=null,loadingIndicator:y,...A}=a,g=(0,s.A)(u),C=null!=y?y:(0,j.jsx)(x.A,{"aria-labelledby":g,color:"inherit",size:16}),S={...a,edge:n,color:l,disabled:d,disableFocusRipple:c,loading:m,loadingIndicator:C,size:p},w=b(S);return(0,j.jsxs)(v,{id:m?g:u,className:(0,r.A)(w.root,o),centerRipple:!0,focusRipple:!c,disabled:d||m,ref:t,...A,ownerState:S,children:["boolean"==typeof m&&(0,j.jsx)("span",{className:w.loadingWrapper,style:{display:"contents"},children:(0,j.jsx)(f,{className:w.loadingIndicator,ownerState:S,children:m&&C})}),i]})})},3409:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var n=a(5155),r=a(2115),i=a(5695),o=a(7217),s=a(4581),l=a(700),d=a(8534),c=a(2110),h=a(3731),p=a(4296),x=a(8407),u=a(7976),m=a(6033),y=a(404),A=a(4263),g=a(9776),j=a(3127),b=a(9505);function v(){var e,t,a;let{id:v}=(0,i.useParams)(),[f,C]=(0,r.useState)(null),[S,w]=(0,r.useState)({}),[z,E]=(0,r.useState)([]),[I,k]=(0,r.useState)(""),[N,D]=(0,r.useState)(""),[T,R]=(0,r.useState)(""),[W,P]=(0,r.useState)(""),[O,L]=(0,r.useState)(""),[B,M]=(0,r.useState)(!1),[q,H]=(0,r.useState)(""),[_,F]=(0,r.useState)(""),[J,U]=(0,r.useState)(!1),V=(0,i.useRouter)(),X=(0,r.useCallback)(async()=>{if(v){let e=await fetch("/api/tenants/".concat(v)),t=await e.json();C(t),w(t.customFields||{});let a=await fetch("/api/admin/fields");E(await a.json())}},[v]);(0,r.useEffect)(()=>{X()},[X]);let G=(e,t)=>{w(a=>({...a,[e]:t}))},K=async()=>{await fetch("/api/tenants/".concat(v),{method:"DELETE"}),V.push("/tenants")},Q=async e=>{e.preventDefault(),await fetch("/api/tenants/".concat(v,"/monthly-pay-history"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rent:parseFloat(I),heatingCost:parseFloat(N),additionalCost:parseFloat(T),startDate:W,endDate:O})}),k(""),D(""),R(""),P(""),L(""),M(!1),X()},Y=async e=>{await fetch("/api/tenants/".concat(v,"/monthly-pay-history/").concat(e),{method:"DELETE"}),X()},Z=async e=>{e.preventDefault(),await fetch("/api/tenants/".concat(v,"/notes"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({note:q,date:_})}),H(""),F(""),U(!1),X()},$=async e=>{await fetch("/api/tenants/".concat(v,"/notes/").concat(e),{method:"DELETE"}),X()},ee=async e=>{e.preventDefault(),await fetch("/api/tenants/".concat(v),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:f.name,customFields:S})}),V.push("/tenants/".concat(v,"/edit"))},et=e=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e);return f?(0,n.jsxs)(o.A,{children:[(0,n.jsxs)(s.A,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",pb:3},children:[(0,n.jsxs)(s.A,{sx:{flex:1,minWidth:"288px"},children:[(0,n.jsx)(l.A,{variant:"h1",sx:{color:"primary.main"},children:"Tenant Details"}),(0,n.jsx)(l.A,{variant:"body2",sx:{color:"secondary.main"},children:"View and manage tenant information"})]}),(0,n.jsx)(d.A,{variant:"contained",color:"primary",onClick:()=>ee(new Event("submit")),children:"Save Changes"}),(0,n.jsx)(d.A,{variant:"contained",color:"secondary",onClick:K,sx:{ml:2},children:"Delete Tenant"})]}),(0,n.jsx)("form",{onSubmit:ee,id:"edit-tenant-form",children:(0,n.jsxs)(c.A,{container:!0,spacing:2,sx:{mb:2},children:[(0,n.jsx)(c.A,{size:12,children:(0,n.jsx)(h.A,{label:"Tenant Name",value:f.name,onChange:e=>C({...f,name:e.target.value}),fullWidth:!0,required:!0})}),z.map(e=>(0,n.jsx)(c.A,{size:{sm:12,md:"text"===e.type?12:4},children:(0,n.jsx)(h.A,{label:e.name,type:"number"===e.type||"currency"===e.type?"number":e.type,value:S[e.id]||"",onChange:t=>G(e.id,t.target.value),fullWidth:!0,rows:"text"===e.type?2:1,InputLabelProps:"date"===e.type?{shrink:!0}:{}})},e.id))]})}),(0,n.jsx)(l.A,{variant:"h2",sx:{color:"primary.main",pt:2,pb:1},children:"Contact Information"}),(0,n.jsxs)(s.A,{sx:{p:2,display:"grid",gridTemplateColumns:{xs:"1fr",sm:"20% 1fr"},gap:"1.5rem"},children:[(0,n.jsxs)(s.A,{sx:{gridColumn:{xs:"span 1",sm:"span 2"},borderTop:"1px solid",borderColor:"border.main",py:2},children:[(0,n.jsx)(l.A,{variant:"body2",sx:{color:"secondary.main"},children:"Phone"}),(0,n.jsx)(l.A,{variant:"body1",children:(null==(e=f.contact)?void 0:e.phone)||"N/A"})]}),(0,n.jsxs)(s.A,{sx:{gridColumn:{xs:"span 1",sm:"span 2"},borderTop:"1px solid",borderColor:"border.main",py:2},children:[(0,n.jsx)(l.A,{variant:"body2",sx:{color:"secondary.main"},children:"Email"}),(0,n.jsx)(l.A,{variant:"body1",children:(null==(t=f.contact)?void 0:t.email)||"N/A"})]}),(0,n.jsxs)(s.A,{sx:{gridColumn:{xs:"span 1",sm:"span 2"},borderTop:"1px solid",borderColor:"border.main",py:2},children:[(0,n.jsx)(l.A,{variant:"body2",sx:{color:"secondary.main"},children:"Address"}),(0,n.jsx)(l.A,{variant:"body1",children:(null==(a=f.contact)?void 0:a.address)||"N/A"})]})]}),(0,n.jsx)(l.A,{variant:"h2",sx:{color:"primary.main",pt:2,pb:1},children:"Monthly Pay History"}),(0,n.jsx)(p.A,{component:x.A,sx:{border:"1px solid",borderColor:"border.main",borderRadius:"12px"},children:(0,n.jsxs)(u.A,{"aria-label":"monthly pay history table",children:[(0,n.jsx)(m.A,{children:(0,n.jsxs)(y.A,{children:[(0,n.jsx)(A.A,{sx:{width:"150px"},children:"Start Date"}),(0,n.jsx)(A.A,{sx:{width:"150px"},children:"End Date"}),(0,n.jsx)(A.A,{align:"right",children:"Rent"}),(0,n.jsx)(A.A,{align:"right",children:"Heating"}),(0,n.jsx)(A.A,{align:"right",children:"Additional"}),(0,n.jsx)(A.A,{align:"right",children:"Total"}),(0,n.jsx)(A.A,{sx:{width:"100px"}})]})}),(0,n.jsx)(g.A,{children:(f.monthlyPayHistory||[]).map(e=>(0,n.jsxs)(y.A,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,n.jsx)(A.A,{sx:{color:"secondary.main"},children:e.startDate}),(0,n.jsx)(A.A,{sx:{color:"secondary.main"},children:e.endDate||"Current"}),(0,n.jsx)(A.A,{align:"right",sx:{color:"secondary.main"},children:et(e.rent)}),(0,n.jsx)(A.A,{align:"right",sx:{color:"secondary.main"},children:et(e.heatingCost)}),(0,n.jsx)(A.A,{align:"right",sx:{color:"secondary.main"},children:et(e.additionalCost)}),(0,n.jsx)(A.A,{align:"right",sx:{color:"primary.main",fontWeight:700},children:et(e.rent+e.heatingCost+e.additionalCost)}),(0,n.jsx)(A.A,{align:"right",children:(0,n.jsx)(j.A,{edge:"end","aria-label":"delete",onClick:()=>Y(e.id),children:(0,n.jsx)(b.A,{})})})]},e.id))})]})}),!B&&(0,n.jsx)(d.A,{variant:"outlined",onClick:()=>M(!0),sx:{mt:2},children:"Add Monthly Pay Entry"}),B&&(0,n.jsxs)("form",{onSubmit:Q,children:[(0,n.jsxs)(c.A,{container:!0,spacing:2,sx:{mt:2},children:[(0,n.jsx)(c.A,{size:{sm:12,md:4},children:(0,n.jsx)(h.A,{label:"Rent Amount",value:I,onChange:e=>k(e.target.value),type:"number",fullWidth:!0,required:!0})}),(0,n.jsx)(c.A,{size:{sm:12,md:4},children:(0,n.jsx)(h.A,{label:"Heating Cost",value:N,onChange:e=>D(e.target.value),type:"number",fullWidth:!0,required:!0})}),(0,n.jsx)(c.A,{size:{sm:12,md:4},children:(0,n.jsx)(h.A,{label:"Additional Cost",value:T,onChange:e=>R(e.target.value),type:"number",fullWidth:!0,required:!0})}),(0,n.jsx)(c.A,{size:{sm:12,md:4},children:(0,n.jsx)(h.A,{label:"Start Date",value:W,onChange:e=>P(e.target.value),type:"date",fullWidth:!0,InputLabelProps:{shrink:!0},required:!0})}),(0,n.jsx)(c.A,{size:{sm:12,md:4},children:(0,n.jsx)(h.A,{label:"End Date",value:O,onChange:e=>L(e.target.value),type:"date",fullWidth:!0,InputLabelProps:{shrink:!0}})})]}),(0,n.jsxs)(s.A,{sx:{mt:2},children:[(0,n.jsx)(d.A,{type:"submit",variant:"contained",color:"primary",children:"Save Monthly Pay Entry"}),(0,n.jsx)(d.A,{variant:"outlined",onClick:()=>M(!1),sx:{ml:2},children:"Cancel"})]})]}),(0,n.jsx)(l.A,{variant:"h2",sx:{color:"primary.main",pt:2,pb:1},children:"Notes History"}),(0,n.jsx)(p.A,{component:x.A,sx:{border:"1px solid",borderColor:"border.main",borderRadius:"12px"},children:(0,n.jsxs)(u.A,{"aria-label":"notes history table",children:[(0,n.jsx)(m.A,{children:(0,n.jsxs)(y.A,{children:[(0,n.jsx)(A.A,{sx:{width:"150px"},children:"Date"}),(0,n.jsx)(A.A,{children:"Note"}),(0,n.jsx)(A.A,{sx:{width:"100px"}})]})}),(0,n.jsx)(g.A,{children:(f.notes||[]).map(e=>(0,n.jsxs)(y.A,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,n.jsx)(A.A,{sx:{color:"secondary.main"},children:e.date}),(0,n.jsx)(A.A,{sx:{color:"secondary.main"},children:e.note}),(0,n.jsx)(A.A,{align:"right",children:(0,n.jsx)(j.A,{edge:"end","aria-label":"delete",onClick:()=>$(e.id),children:(0,n.jsx)(b.A,{})})})]},e.id))})]})}),!J&&(0,n.jsx)(d.A,{variant:"outlined",onClick:()=>U(!0),sx:{mt:2},children:"Add Note"}),J&&(0,n.jsxs)("form",{onSubmit:Z,children:[(0,n.jsxs)(c.A,{container:!0,spacing:2,sx:{mt:2},children:[(0,n.jsx)(c.A,{size:12,children:(0,n.jsx)(h.A,{label:"New Note",value:q,onChange:e=>H(e.target.value),fullWidth:!0,multiline:!0,rows:4,required:!0})}),(0,n.jsx)(c.A,{size:{sm:12,md:4},children:(0,n.jsx)(h.A,{label:"Note Date",value:_,onChange:e=>F(e.target.value),type:"date",fullWidth:!0,InputLabelProps:{shrink:!0},required:!0})})]}),(0,n.jsxs)(s.A,{sx:{mt:2},children:[(0,n.jsx)(d.A,{type:"submit",variant:"contained",color:"primary",children:"Save Note"}),(0,n.jsx)(d.A,{variant:"outlined",onClick:()=>U(!1),sx:{ml:2},children:"Cancel"})]})]})]}):(0,n.jsx)("p",{children:"Loading..."})}},4672:(e,t,a)=>{Promise.resolve().then(a.bind(a,3409))},9505:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var n=a(7515),r=a(5155);let i=(0,n.A)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")}},e=>{var t=t=>e(e.s=t);e.O(0,[4475,9008,3731,297,6780,8441,1684,7358],()=>t(4672)),_N_E=e.O()}]);